<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>X# Compiler</title>

		<link rel="preconnect" href="https://fonts.googleapis.com" />
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
		<link
			href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,100..800;1,100..800&display=swap"
			rel="stylesheet"
		/>

		<link
			rel="stylesheet"
			href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css"
		/>
		<link rel="stylesheet" href="style.css" />
	</head>
	<body>
		<div class="container">
			<h2>Configure Assembly</h2>
			<form>
				<label for="language">Choose an assembly language:</label>
				<select id="language" name="language">
					<option value="EmeraldASM">EmeraldASM</option>
					<option value="XenonASM">XenonASM</option>
				</select>
				<br />
				<label for="store-res">Choose where to store the result:</label>
				<select id="store-res" name="store-res">
					<option value="AX">AX</option>
					<option value="DX">DX</option>
				</select>
			</form>

			<h2>Configure Workspace</h2>
			<form>
				<label for="show-rpn">Show RPN?&nbsp;</label>
				<input type="checkbox" id="show-rpn" name="show-rpn" />
				<br />
				<label for="fn">File name:</label>
				<input type="text" id="fn" name="fn" />
				<span>.xs</span>
			</form>

			<hr />

			<h2>X# Compiler</h2>
			<div class="buttons">
				<button type="button" id="import-btn" title="Import">
					<i class="fa-solid fa-file-import"></i> Import
				</button>
				<button type="button" id="export-btn" title="Export">
					<i class="fa-solid fa-file-export"></i> Export
				</button>
				<input
					type="file"
					id="file-input"
					style="display: none"
					accept=".xs"
				/>
				<button type="button" id="compile-btn" title="Compile">
					<i class="fa-solid fa-play"></i> Compile
				</button>
			</div>
			<div
				contenteditable="true"
				id="code"
				autofocus="true"
				class="div-code"
			></div>
			<div id="rpn-output" class="div-code">
				<span class="label">RPN</span>
			</div>
			<div id="output" class="div-code">
				<span class="label">Assembly Output</span>
			</div>

			<hr />

			<h2>Documentation</h2>
			<details>
				<summary>Overview</summary>
				<p>
					<span class="token-inst">X#</span>, or
					<span class="token-inst">XSharp</span>, is a programming
					language developed by
					<span class="highlight">creeperdoesredstone</span>
					originally for his
					<span class="token-value">Xenon</span> CPU to aid in
					developing assembly programs.
				</p>
				<p>
					Now, it is mainly used for
					<span class="highlight">creeperdoesredstone</span>'s new
					<span class="highlight">Xenon-124 VM</span> in
					<span class="token-register">OS Wars 26</span>, but more VMs
					can be implemented if necessary.
				</p>
			</details>
			<details>
				<summary>Syntax and Structure</summary>
				<h4>Statement Termination</h4>
				<p>
					Statements must be separated using a semicolon
					(<code>;</code>).
				</p>
				<br />
				<h4>Literals</h4>
				<p>X# currently supports these types of literals:</p>
				<table>
					<tr>
						<th>Type</th>
						<th>Format</th>
						<th>Example</th>
					</tr>
					<tr>
						<td><code class="token-inst">int</code></td>
						<td id="dt-int">int16</td>
						<td>
							<code>123</code>, <code>0</code>, <code>-57</code>
						</td>
					</tr>
					<tr>
						<td><code class="token-inst">float</code></td>
						<td id="dt-float">fp16 (bias = 15)</td>
						<td>
							<code>3.125</code>, <code>0.0625</code>,
							<code>-10.5</code>
						</td>
					</tr>
				</table>
			</details>
			<details>
				<summary>Operators and Precedence</summary>
				<p>
					<span class="token-inst">X#</span> supports standard
					arithmetic operators. Expressions are evaluated using
					standard operator precedence rules, enforced by parentheses
					(<code>()</code>):
				</p>
				<table>
					<tr>
						<th>Operator</th>
						<th>Type</th>
						<th>Precedence</th>
						<th>Associativity</th>
					</tr>
					<tr>
						<td><code>-</code>, <code>+</code> (unary)</td>
						<td>Unary</td>
						<td>5</td>
						<td>right</td>
					</tr>
					<tr>
						<td><code>^</code></td>
						<td>Binary</td>
						<td>4</td>
						<td>right</td>
					</tr>
					<tr>
						<td><code>*</code>, <code>/</code>, <code>%</code></td>
						<td>Binary</td>
						<td>3</td>
						<td>left</td>
					</tr>
					<tr>
						<td><code>+</code>, <code>-</code></td>
						<td>Binary</td>
						<td>2</td>
						<td>left</td>
					</tr>
					<tr>
						<td><code>=</code></td>
						<td>Binary</td>
						<td>1</td>
						<td>right</td>
					</tr>
				</table>
			</details>
			<details>
				<summary>Variables and Constants</summary>
				<h4>Declaring variables</h4>
				<p>
					Variables are declared using the <code>var</code> keyword as
					follows:
				</p>
				<div class="code-block">var identifier: dataType = expr;</div>
				<br />
				<h4>Changing values of variables</h4>
				<p>
					Once declared, the value of a variable can be changed using
					the assignment operator:
				</p>
				<div class="code-block">identifier = expr;</div>
				<p>
					Variables can be assigned a value with the same data type.
				</p>
				<p>
					For example, if we have this code then the compiler would
					throw an error:
				</p>
				<div class="code-block">var a: int = 14;<br />a = 2.0;</div>
				<br />
				<h4>Using constants</h4>
				<p>
					Constants are declared using the <code>const</code> keyword
					as follows:
				</p>
				<div class="code-block">const identifier: dataType = expr;</div>
				<p>
					Once declared, the value of a constant cannot be changed.
					Doing the following would result in an error:
				</p>
				<div class="code-block">const a: int = 14;<br />a = 2;</div>
			</details>
			<details>
				<summary>Parsing</summary>
				<p>
					The Xenon parser uses the
					<span class="token-inst"
						>Shunting Yard Algorithm (SYA)</span
					>
					to convert the infix source code into
					<span class="highlight">Reverse Polish Notation</span>,
					allowing the compiler to execute instructions directly using
					a stack.
				</p>
				<p>
					You can read more about the Shunting Yard Algorithm
					<a
						href="https://brilliant.org/wiki/shunting-yard-algorithm/"
						>here</a
					>.
				</p>
			</details>
			<details>
				<summary>Supported ISAs</summary>
				<p>
					The <span class="token-inst">X# Compiler</span> currently
					supports these ISAs:
				</p>
				<details>
					<summary>Xenon-124 ISA (OS Wars 26)</summary>
					<p>
						The <span class="highlight">Xenon-124 ISA</span> is for
						a conceptual
						<span class="token-value">16-bit</span> virtual machine
						by
						<a
							href="https://scratch.mit.edu/users/creeperdoesredstone/"
							target="_blank"
							rel="noopener"
							>creeperdoesredstone</a
						>.
					</p>
					<p>
						The ISA for the Xenon-124 VM can be found
						<a
							href="https://docs.google.com/spreadsheets/d/1lWkRa2bWt4Imss0K8sfAVuTmYVx9m5RivHfTwb5bBWM/edit?usp=sharing"
							target="_blank"
							rel="noopener"
							>here</a
						>.
					</p>
					<br />
					<h4>Specs:</h4>
					<p>
						- 4 <span class="token-value">16-bit</span> registers:
						<span class="token-register">AX</span>,
						<span class="token-register">BX</span>,
						<span class="token-register">CX</span>, and
						<span class="token-register">DX</span>.
					</p>
					<p>
						- 2 <span class="token-value">16-bit</span> pointers:
						<span class="token-register">BP</span> and
						<span class="token-register">SP</span>.
					</p>
					<p>
						- <span class="token-value">65536</span> addresses =>
						<span class="token-value">128KiB</span> of RAM and PROM.
					</p>
					<p>
						- <span class="token-value">42</span> instructions so
						far.
					</p>
				</details>
				<details>
					<summary>Emerald ISA (OS Wars 25)</summary>
					<p>
						The <span class="highlight">Emerald ISA</span> is for an
						<span class="token-value">8-bit</span> virtual machine
						developed by
						<a
							href="https://scratch.mit.edu/users/creeperdoesredstone/"
							target="_blank"
							rel="noopener"
							>creeperdoesredstone</a
						>
						and
						<a
							href="https://scratch.mit.edu/users/ttt1101/"
							target="_blank"
							rel="noopener"
							>ttt1101</a
						>.
					</p>
					<p>
						The ISA for the Emerald VM can be found
						<a
							href="https://docs.google.com/spreadsheets/d/1lWkRa2bWt4Imss0K8sfAVuTmYVx9m5RivHfTwb5bBWM/edit?usp=sharing"
							target="_blank"
							rel="noopener"
							>here</a
						>.
					</p>
					<br />
					<h4>Specs:</h4>
					<p>
						- 4 <span class="token-value">8-bit</span> registers:
						<span class="token-register">SX</span>,
						<span class="token-register">AX</span>,
						<span class="token-register">BX</span>, and
						<span class="token-register">DX</span>.
					</p>
					<p>
						- 2 <span class="token-value">16-bit</span> pointers:
						<span class="token-register">BP</span> and
						<span class="token-register">SP</span>.
					</p>
					<p>
						- <span class="token-value">4096</span> addresses =>
						<span class="token-value">4KiB</span> of memory.
					</p>
					<p>- <span class="token-value">24</span> instructions.</p>
				</details>
			</details>
			<hr />
		</div>

		<script src="compiler.js"></script>
		<script src="script.js"></script>
		<script src="index.js"></script>
	</body>
</html>
